<?php

use muh\accounting\Services\JournalService;

// افترض أننا أنشأنا حسابات محددة مسبقاً ومعرفاتها كما يلي:
// - حساب مصروف الرواتب: account_id = 101
// - حساب مصروف المكافآت: account_id = 102
// - حساب الرواتب المستحقة (صافي المرتب): account_id = 201
// - حساب خصم قسط السلفة: account_id = 202
// - حساب الخصميات العامة: account_id = 203

$journalService = new JournalService();

$entryDate = date('Y-m-d');
$description = "صرف مرتب موظف: مرتب 2000 دينار، مكافأة 150 دينار، خصم قسط سلفة 150 دينار، وخصميات عامة 100 دينار";

// تفاصيل الطرف المدين: المصروفات (المصروف الرئيسي للرواتب والمكافآت)
$debitDetails = [
    ['account_id' => 101, 'amount' => 2000], // مصروف الرواتب
    ['account_id' => 102, 'amount' => 150],  // مصروف المكافآت
];

// تفاصيل الطرف الدائن: الالتزامات (صافي المرتب المستحق للموظف والخصومات)
$creditDetails = [
    ['account_id' => 201, 'amount' => 1900], // صافي المرتب (2000 + 150 - 150 - 100)
    ['account_id' => 202, 'amount' => 150],  // خصم قسط السلفة
    ['account_id' => 203, 'amount' => 100],  // خصميات عامة
];

try {
    $journalEntry = $journalService->createMultiAccountEntry($entryDate, $description, $debitDetails, $creditDetails);
    echo "تم إنشاء القيد المحاسبي بنجاح، رقم القيد: " . $journalEntry->id;
} catch (\Exception $e) {
    echo "حدث خطأ أثناء إنشاء القيد المحاسبي: " . $e->getMessage();
}
/*
شرح المثال:
تحديد الحسابات:

افترضنا أن معرفات الحسابات موجودة مسبقاً:
101: حساب مصروف الرواتب.
102: حساب مصروف المكافآت.
201: حساب الرواتب المستحقة (صافي المرتب).
202: حساب خصم قسط السلفة.
203: حساب الخصميات العامة.
تفاصيل الطرف المدين:

تم تسجيل 2000 دينار في حساب مصروف الرواتب.
وتم تسجيل 150 دينار في حساب مصروف المكافآت.
إجمالي المدين = 2000 + 150 = 2150 دينار.
تفاصيل الطرف الدائن:

يتم خصم 150 دينار لخصم قسط السلفة و100 دينار لخصميات عامة، فيصبح صافي المرتب = 2150 - 150 - 100 = 1900 دينار.
يتم تسجيل 1900 دينار في حساب الرواتب المستحقة.
كما تُسجل مبالغ الخصم 150 دينار في حساب خصم قسط السلفة و100 دينار في حساب الخصميات العامة.
إجمالي الدائن = 1900 + 150 + 100 = 2150 دينار.
تنفيذ العملية:

يتم استدعاء دالة createMultiAccountEntry في خدمة القيود المحاسبية لإنشاء القيد.
في حال نجاح العملية، يتم طباعة رقم القيد.
إذا حدث خطأ، يتم طباعة رسالة الخطأ.
هذا المثال يوضح كيفية استخدام المكتبة لإضافة قيد محاسبي يعكس صرف مرتب موظف مع المكافآت والخصومات بطريقة متوازنة باستخدام طريقة القيد المزدوج.
*/